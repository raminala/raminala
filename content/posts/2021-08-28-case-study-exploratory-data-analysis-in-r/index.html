---
title: 'Case Study: Exploratory Data Analysis in R'
author: ''
date: '2021-08-28'
slug: []
categories: []
tags:
  - data_visualization
  - data_wrangling
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>


<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## -- Attaching packages --------------------------------------- tidyverse 1.3.1 --</code></pre>
<pre><code>## v ggplot2 3.3.3     v purrr   0.3.4
## v tibble  3.1.2     v dplyr   1.0.6
## v tidyr   1.1.3     v stringr 1.4.0
## v readr   1.4.0     v forcats 0.5.1</code></pre>
<pre><code>## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>votes &lt;- read.csv(&quot;votes.csv&quot;)</code></pre>
<div id="filtering-rows" class="section level2">
<h2>1-2 Filtering rows</h2>
<p>The vote column in the dataset has a number that represents that country’s vote:</p>
<p>1 = Yes
2 = Abstain
3 = No
8 = Not present
9 = Not a member
One step of data cleaning is removing observations (rows) that you’re not interested in. In this case, you want to remove “Not present” and “Not a member”.</p>
<pre class="r"><code># Filter for votes that are &quot;yes&quot;, &quot;abstain&quot;, or &quot;no&quot;
votes %&gt;% filter(vote&lt;=3)</code></pre>
</div>
<div id="adding-a-year-column" class="section level2">
<h2>1-3 Adding a year column</h2>
<p>The next step of data cleaning is manipulating your variables (columns) to make them more informative.</p>
<p>In this case, you have a session column that is hard to interpret intuitively. But since the UN started voting in 1946, and holds one session per year, you can get the year of a UN resolution by adding 1945 to the session number.</p>
<pre class="r"><code># Add another %&gt;% step to add a year column
votes %&gt;%
  filter(vote &lt;= 3) %&gt;%
mutate(year=session+1945)</code></pre>
</div>
<div id="adding-a-country-column" class="section level2">
<h2>1-4 Adding a country column</h2>
<p>The country codes in the ccode column are what’s called Correlates of War codes. This isn’t ideal for an analysis, since you’d like to work with recognizable country names.</p>
<p>You can use the countrycode package to translate. For example:</p>
<p>library(countrycode)</p>
</div>
<div id="translate-the-country-code-2" class="section level1">
<h1>Translate the country code 2</h1>
<blockquote>
<p>countrycode(2, “cown”, “country.name”)
[1] “United States”</p>
</blockquote>
</div>
<div id="translate-multiple-country-codes" class="section level1">
<h1>Translate multiple country codes</h1>
<blockquote>
<p>countrycode(c(2, 20, 40), “cown”, “country.name”)
[1] “United States” “Canada” “Cuba”</p>
</blockquote>
<pre class="r"><code># Load the countrycode package
library(countrycode)

# Convert country code 100
countrycode(100, &quot;cown&quot;, &quot;country.name&quot;)</code></pre>
<pre><code>## [1] &quot;Colombia&quot;</code></pre>
<pre class="r"><code># Add a country column within the mutate: votes_processed
votes_processed &lt;- votes %&gt;%
  filter(vote &lt;= 3) %&gt;%
  mutate(year = session + 1945,
         country = countrycode(ccode, &quot;cown&quot;, &quot;country.name&quot;))</code></pre>
<div id="summarizing-the-full-dataset" class="section level2">
<h2>1-6 Summarizing the full dataset</h2>
<p>In this analysis, you’re going to focus on “% of votes that are yes” as a metric for the “agreeableness” of countries.</p>
<p>You’ll start by finding this summary for the entire dataset: the fraction of all votes in their history that were “yes”. Note that within your call to summarize(), you can use n() to find the total number of votes and mean(vote == 1) to find the fraction of “yes” votes.</p>
<pre class="r"><code># Print votes_processed
print(votes_processed)

# Find total and fraction of &quot;yes&quot; votes
votes_processed %&gt;%
  summarize(total = n(),
            percent_yes = mean(vote == 1))</code></pre>
</div>
<div id="summarizing-by-year" class="section level2">
<h2>1-7 Summarizing by year</h2>
<p>The summarize() function is especially useful because it can be used within groups.</p>
<p>For example, you might like to know how much the average “agreeableness” of countries changed from year to year. To examine this, you can use group_by() to perform your summary not for the entire dataset, but within each year.</p>
<pre class="r"><code># Change this code to summarize by year
votes_processed %&gt;%
group_by(year) %&gt;%
  summarize(total = n(),
            percent_yes = mean(vote == 1))</code></pre>
</div>
<div id="summarizing-by-country" class="section level2">
<h2>1-8 Summarizing by country</h2>
<p>In the last exercise, you performed a summary of the votes within each year. You could instead summarize() within each country, which would let you compare voting patterns between countries.</p>
</div>
<div id="section" class="section level2">
<h2>1-10</h2>
</div>
<div id="section-1" class="section level2">
<h2>1-11</h2>
</div>
</div>
